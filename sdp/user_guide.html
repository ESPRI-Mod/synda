

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>User guide &mdash; synda 3.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="synda 3.0 documentation" href="../index.html"/>
        <link rel="up" title="Synda Post-Processing Module" href="sdp.html"/>
        <link rel="next" title="Worker User Guide" href="worker_user_guide.html"/>
        <link rel="prev" title="Pipeline creation" href="pipeline_file.html"/> 

  
  <script src="../static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> synda
          

          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../sdt/sdt.html">Synda Transfer Module</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="sdp.html">Synda Post-Processing Module</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sdp.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdp.html#upgrade">Upgrade</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdp.html#configuration">Configuration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="sdp.html#usage">Usage</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">User guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-post-processing">Start post-processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-sdw-service">Start <code class="docutils literal"><span class="pre">sdw</span></code> service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#communication-test-between-modules">Communication test between modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#error-management">Error management</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worker_user_guide.html">Worker User Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="replication.html">ESGF replication</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../files.html">Synda Files and Folders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_ref.html">Synda Command reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../log.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License and Disclaimer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">synda</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="sdp.html">Synda Post-Processing Module</a> &raquo;</li>
      
    <li>User guide</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../sources/sdp/user_guide.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="user-guide">
<span id="user-guide-sdp"></span><h1>User guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Synda Post-Processing module is used to transform ESGF data files. In the centre is a &#8220;pipeline&#8221; database that list individual jobs to be run.
These jobs are claimed and processed by Workers - autonomous processes that are running on the compute farm and connect
to the pipeline database to report about the progress of Jobs or claim some more. When a Worker discovers that
its predefined time is up or that there are no more Jobs to do, it claims no more Jobs and exits the compute farm
freeing the resources. Thus, Synda allows a parallel, orderly and asynchronous post-processing on each tracked dataset.</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sdt-module">
<h3><code class="docutils literal"><span class="pre">sdt</span></code> module<a class="headerlink" href="#sdt-module" title="Permalink to this headline">¶</a></h3>
<p>Set <code class="docutils literal"><span class="pre">post_processing</span></code> parameter to <code class="docutils literal"><span class="pre">true</span></code> in <code class="docutils literal"><span class="pre">$ST\_HOME/conf/sdt.conf</span></code>:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>post_processing=true
</pre></div>
</div>
</div>
<div class="section" id="sdp-module">
<h3><code class="docutils literal"><span class="pre">sdp</span></code> module<a class="headerlink" href="#sdp-module" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Edit <code class="docutils literal"><span class="pre">/etc/synda/sdp/credentials.conf</span></code> file to configure the RPC server:</li>
</ul>
<div class="highlight-text"><div class="highlight"><pre><span></span>[rpcserver]
username=xxxxxx
password=xxxxxx
</pre></div>
</div>
<ul class="simple">
<li><a class="reference internal" href="config_param_ref.html#config-param-ref-sdp"><span class="std std-ref">Edit configuration file</span></a>.</li>
<li><a class="reference internal" href="pipeline_file.html#pipeline-file"><span class="std std-ref">Declare your pipelines and bindings</span></a>.</li>
</ul>
</div>
</div>
<div class="section" id="start-post-processing">
<h2>Start post-processing<a class="headerlink" href="#start-post-processing" title="Permalink to this headline">¶</a></h2>
<p>In source installation, run command below:`</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>synda_pp daemon start
</pre></div>
</div>
<p>In system package installation, run command below:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>service sdp start
</pre></div>
</div>
</div>
<div class="section" id="start-sdw-service">
<h2>Start <code class="docutils literal"><span class="pre">sdw</span></code> service<a class="headerlink" href="#start-sdw-service" title="Permalink to this headline">¶</a></h2>
<p>When all the events are sent from <code class="docutils literal"><span class="pre">sdt</span></code> to <code class="docutils literal"><span class="pre">sdp</span></code> and all corresponding post-processing entries are created into <code class="docutils literal"><span class="pre">sdp.db</span></code> pending for execution by a <a class="reference internal" href="worker_user_guide.html#user-guide-sdw"><span class="std std-ref">Synda Worker</span></a>.</p>
<p>This is the client side post-processing daemon (aka &#8220;worker&#8221;). To start the service, run command below:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>synda_wo --script_dir /your/scripts start
</pre></div>
</div>
</div>
<div class="section" id="communication-test-between-modules">
<h2>Communication test between modules<a class="headerlink" href="#communication-test-between-modules" title="Permalink to this headline">¶</a></h2>
<p>Test communication between <code class="docutils literal"><span class="pre">sdt</span></code> and <code class="docutils literal"><span class="pre">sdp</span></code></p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">$ST_HOME</span>/lib/sd/sdppproxy.py -v
</pre></div>
</div>
<p>If tests failed, check if credentials and are :ref:<code class="docutils literal"><span class="pre">`sdp.conf</span></code> &lt;config-param-ref-sdp&gt;` are correctly set then restart the services.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s download a file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>synda install -y sfcWind_ARC-44_MPI-M-MPI-ESM-LR_historical_r1i1p1_SMHI-RCA4-SN_v1_sem_197012-198011.nc
</pre></div>
</div>
<p>After a few minutes, the file should have been transferred and the jobs should have been triggered.</p>
<p>To check the result, let&#8217;s see the logfile:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>vi <span class="nv">$SP_HOME</span>/log/worker.log
</pre></div>
</div>
<p>If all went well, the logfile should look like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>2017/01/10 09:09:56 AM INFO Processing job <span class="o">(</span><span class="nv">transition</span><span class="o">=</span>task_A,args<span class="o">={</span>u<span class="s1">&#39;pipeline&#39;</span>: u<span class="s1">&#39;P001&#39;</span>, u<span class="s1">&#39;data_folder&#39;</span>: u<span class="s1">&#39;/home/jerome/sdp/data&#39;</span>, u<span class="s1">&#39;project&#39;</span>: u<span class="s1">&#39;CORDEX&#39;</span>, u<span class="s1">&#39;variable&#39;</span>: u<span class="s1">&#39;s</span>
<span class="s1">fcWind&#39;</span>, u<span class="s1">&#39;model&#39;</span>: u<span class="s1">&#39;RCA4-SN&#39;</span>, u<span class="s1">&#39;dataset_pattern&#39;</span>: u<span class="s1">&#39;cordex/output/ARC-44/SMHI/MPI-M-MPI-ESM-LR/historical/r1i1p1/RCA4-SN/v1/sem/sfcWind/v20140123&#39;</span><span class="o">}</span>,job_class<span class="o">=</span>foo,start_date<span class="o">=</span>2017-01-10 09:09:56.791281,ppprun_id<span class="o">=</span>1,error_msg<span class="o">=</span>None<span class="o">)</span>
2017/01/10 09:09:56 AM DEBUG Script <span class="k">return</span> code: 0
2017/01/10 09:09:56 AM DEBUG Script stdout:
2017/01/10 09:09:56 AM DEBUG Script stderr:
2017-01-10 09:09:56 - INF001 - task_A.sh script started
2017-01-10 09:09:56 - INF002 - dataset_pattern: cordex/output/ARC-44/SMHI/MPI-M-MPI-ESM-LR/historical/r1i1p1/RCA4-SN/v1/sem/sfcWind/v20140123
2017-01-10 09:09:56 - INF003 - task_A.sh script ends.
2017/01/10 09:09:56 AM INFO Processing job <span class="o">(</span><span class="nv">transition</span><span class="o">=</span>task_B,args<span class="o">={</span>u<span class="s1">&#39;pipeline&#39;</span>: u<span class="s1">&#39;P001&#39;</span>, u<span class="s1">&#39;data_folder&#39;</span>: u<span class="s1">&#39;/home/jerome/sdp/data&#39;</span>, u<span class="s1">&#39;project&#39;</span>: u<span class="s1">&#39;CORDEX&#39;</span>, u<span class="s1">&#39;variable&#39;</span>: u<span class="s1">&#39;sfcWind&#39;</span>, u<span class="s1">&#39;model&#39;</span>: u<span class="s1">&#39;RCA4-SN&#39;</span>, u<span class="s1">&#39;dataset_pattern&#39;</span>: u<span class="s1">&#39;cordex/output/ARC-44/SMHI/MPI-M-MPI-ESM-LR/historical/r1i1p1/RCA4-SN/v1/sem/sfcWind/v20140123&#39;</span><span class="o">}</span>,job_class<span class="o">=</span>bar,start_date<span class="o">=</span>2017-01-10 09:09:56.887659,ppprun_id<span class="o">=</span>1,error_msg<span class="o">=</span>None<span class="o">)</span>
2017/01/10 09:09:56 AM DEBUG Script <span class="k">return</span> code: 0
2017/01/10 09:09:56 AM DEBUG Script stdout:
2017/01/10 09:09:56 AM DEBUG Script stderr:
2017-01-10 09:09:56 - INF001 - task_B.sh script started
2017-01-10 09:09:56 - INF002 - dataset_pattern: cordex/output/ARC-44/SMHI/MPI-M-MPI-ESM-LR/historical/r1i1p1/RCA4-SN/v1/sem/sfcWind/v20140123
2017-01-10 09:09:56 - INF003 - task_B.sh script ends.
2017/01/10 09:09:57 AM INFO Processing job <span class="o">(</span><span class="nv">transition</span><span class="o">=</span>task_C,args<span class="o">={</span>u<span class="s1">&#39;pipeline&#39;</span>: u<span class="s1">&#39;P001&#39;</span>, u<span class="s1">&#39;data_folder&#39;</span>: u<span class="s1">&#39;/home/jerome/sdp/data&#39;</span>, u<span class="s1">&#39;project&#39;</span>: u<span class="s1">&#39;CORDEX&#39;</span>, u<span class="s1">&#39;variable&#39;</span>: u<span class="s1">&#39;sfcWind&#39;</span>, u<span class="s1">&#39;model&#39;</span>: u<span class="s1">&#39;RCA4-SN&#39;</span>, u<span class="s1">&#39;dataset_pattern&#39;</span>: u<span class="s1">&#39;cordex/output/ARC-44/SMHI/MPI-M-MPI-ESM-LR/historical/r1i1p1/RCA4-SN/v1/sem/sfcWind/v20140123&#39;</span><span class="o">}</span>,job_class<span class="o">=</span>foobar,start_date<span class="o">=</span>2017-01-10 09:09:56.985872,ppprun_id<span class="o">=</span>1,error_msg<span class="o">=</span>None<span class="o">)</span>
2017/01/10 09:09:57 AM DEBUG Script <span class="k">return</span> code: 0
2017/01/10 09:09:57 AM DEBUG Script stdout:
2017/01/10 09:09:57 AM DEBUG Script stderr:
2017-01-10 09:09:57 - INF001 - task_C.sh script started
2017-01-10 09:09:57 - INF002 - dataset_pattern: cordex/output/ARC-44/SMHI/MPI-M-MPI-ESM-LR/historical/r1i1p1/RCA4-SN/v1/sem/sfcWind/v20140123
2017-01-10 09:09:57 - INF003 - task_C.sh script ends.
</pre></div>
</div>
</div>
<div class="section" id="error-management">
<h2>Error management<a class="headerlink" href="#error-management" title="Permalink to this headline">¶</a></h2>
<div class="section" id="getting-information-about-errors">
<h3>Getting information about errors<a class="headerlink" href="#getting-information-about-errors" title="Permalink to this headline">¶</a></h3>
<p>Log files below contain useful information about errors:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">daemon.log</span></code> contains information regarding the daemon execution.</li>
<li><code class="docutils literal"><span class="pre">stacktrace.log</span></code> contains information regarding occurring errors.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Log files are stored in <code class="docutils literal"><span class="pre">$HOME/sdp/log</span></code> folder (source installation) and <code class="docutils literal"><span class="pre">/var/log/synda/sdp</span></code> folder (system package installation).</p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="worker_user_guide.html" class="btn btn-neutral float-right" title="Worker User Guide" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pipeline_file.html" class="btn btn-neutral" title="Pipeline creation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, RACIAZEK, J..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../static/jquery.js"></script>
      <script type="text/javascript" src="../static/underscore.js"></script>
      <script type="text/javascript" src="../static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>